<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Auto Concierge · Dealer Onboarding</title>
  <meta name="description" content="Upgrade to Auto Concierge — turn Instagram traffic into real dealer appointments in Jamaica." />
  <style>
    :root{
      --bg:#f7f7f8;
      --surface:#ffffff;
      --ink:#0b0b0b;
      --muted:#6b7280;
      --muted-2:#9ca3af;
      --brand:#dc2626;
      --brand-2:#ef4444;
      --line:#e5e7eb;
      --shadow:0 20px 50px rgba(15,23,42,.12);
      --radius:18px;
      --gutter:clamp(16px,4vw,24px);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui,-apple-system,BlinkMacSystemFont,"SF Pro Text",Inter,sans-serif;
      color:var(--ink);
      background:
        radial-gradient(circle at 10% 10%, rgba(220,38,38,.08), transparent 45%),
        radial-gradient(circle at 90% 10%, rgba(239,68,68,.08), transparent 45%),
        var(--bg);
    }
    a{text-decoration:none;color:inherit}
    .wrap{max-width:1100px;margin:0 auto;padding:0 var(--gutter)}
    header{
      position:sticky;top:0;z-index:20;
      background:rgba(255,255,255,.9);
      border-bottom:1px solid var(--line);
      backdrop-filter:blur(10px);
    }
    .head-row{display:flex;align-items:center;justify-content:space-between;padding:14px 0;gap:12px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:900}
    .brand-badge{
      width:42px;height:42px;border-radius:12px;background:rgba(220,38,38,.12);
      border:1px solid rgba(220,38,38,.25);display:grid;place-items:center;color:var(--brand);
    }
    .btn{
      appearance:none;border:none;cursor:pointer;
      display:inline-flex;align-items:center;justify-content:center;gap:8px;
      height:40px;padding:0 18px;border-radius:999px;
      font-size:13px;font-weight:900;
    }
    .btn-primary{
      background:linear-gradient(135deg,var(--brand-2),var(--brand));
      color:#fff;box-shadow:0 18px 36px rgba(220,38,38,.25);
    }
    .btn-outline{
      background:#fff;border:1px solid var(--line);color:var(--ink);
      box-shadow:0 8px 16px rgba(15,23,42,.08);
    }
    .marquee{
      background:#0b0b0b;color:#fff;font-size:11px;letter-spacing:.22em;text-transform:uppercase;
    }
    .marquee-track{
      display:flex;gap:24px;padding:10px 0;white-space:nowrap;animation:marquee 20s linear infinite;
    }
    @keyframes marquee{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
    .hero{
      padding:56px 0 28px;
    }
    .hero-grid{
      display:grid;gap:28px;grid-template-columns:1.2fr .8fr;align-items:center;
    }
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:6px 12px;border-radius:999px;border:1px solid var(--line);
      font-size:11px;font-weight:800;color:var(--muted);
      background:#fff;
    }
    h1{font-size:clamp(30px,4vw,46px);margin:12px 0}
    .lead{font-size:15px;color:var(--muted);line-height:1.6}
    .hero-card{
      background:#fff;border-radius:22px;border:1px solid var(--line);
      box-shadow:var(--shadow);padding:22px;
      display:grid;gap:14px;
    }
    .list{margin:0;padding-left:18px;color:var(--muted);font-size:13px;line-height:1.6}
    .section{padding:28px 0}
    .grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    .card{
      background:#fff;border-radius:18px;border:1px solid var(--line);
      box-shadow:0 12px 28px rgba(15,23,42,.08);padding:18px;
    }
    .card h3{margin:0 0 8px;font-size:16px}
    .price{font-size:22px;font-weight:900;color:var(--brand);margin-top:6px}
    .muted{color:var(--muted);font-size:13px}
    .cta-anim{display:inline-flex;align-items:center;gap:8px;min-height:20px}
    .cta-anim span{transition:opacity .35s ease}
    .faq{display:grid;gap:12px}
    .faq-item{background:#fff;border:1px solid var(--line);border-radius:16px;padding:14px}
    .form-grid{display:grid;gap:10px}
    .input{
      border-radius:14px;border:1px solid var(--line);padding:10px 12px;font-size:13px;width:100%;
    }
    .tiers{display:grid;gap:14px;grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}
    .tier-card{padding:18px;border-radius:20px;border:1px solid var(--line);background:#fff;box-shadow:var(--shadow);display:grid;gap:10px}
    .tier-card strong{font-size:16px}
    .badge{display:inline-flex;align-items:center;gap:6px;font-size:11px;font-weight:900;color:var(--brand)}
    .success{background:#ecfdf3;border:1px solid rgba(22,163,74,.25);color:#166534;padding:12px;border-radius:14px;font-size:13px}
    .warning{background:#fff7ed;border:1px solid rgba(234,88,12,.25);color:#9a3412;padding:12px;border-radius:14px;font-size:13px}
    footer{padding:30px 0;color:var(--muted);font-size:12px;text-align:center}
    @media(max-width:860px){
      .hero-grid{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="marquee" aria-hidden="true">
    <div class="wrap">
      <div class="marquee-track">
        <span>14-Day Trial • 1–3% Commission Copy • Dealer Provisioning Included</span>
        <span>Dealer IDs • Live Inventory • WhatsApp Routing</span>
        <span>14-Day Trial • 1–3% Commission Copy • Dealer Provisioning Included</span>
        <span>Dealer IDs • Live Inventory • WhatsApp Routing</span>
      </div>
    </div>
  </div>

  <header>
    <div class="wrap">
      <div class="head-row">
        <div class="brand">
          <div class="brand-badge">AC</div>
          Auto Concierge Jamaica
        </div>
        <a class="btn btn-outline" href="/storefront">Back to Storefront</a>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="hero-grid">
        <div>
          <div class="pill">Dealer onboarding • 14-day trial</div>
          <h1>Stop selling cars from posts.</h1>
          <p class="lead">Turn Instagram traffic into real appointments with a live dealer storefront. Buyers see real availability, request viewings instantly, and your team stays in control.</p>
          <div class="lead" style="margin-top:12px">Trusted commission copy for auctions and agents: <strong>1–3%</strong> with a clean, premium flow.</div>
        </div>
        <div class="hero-card">
          <div class="pill">What you get</div>
          <ul class="list">
            <li>Dealer-specific storefront (not a marketplace).</li>
            <li>WhatsApp routing + live video bookings.</li>
            <li>Inventory, requests, and media in one dashboard.</li>
            <li>Automatic dealer provisioning after checkout.</li>
          </ul>
          <div class="cta-anim">
            <span id="ctaText">Get Listed!</span>
            <span class="muted">• 14-day free trial</span>
          </div>
        </div>
      </div>
    </section>

    <section class="section">
      <h2>How it works</h2>
      <div class="grid">
        <div class="card">
          <h3>1. Choose your tier</h3>
          <p class="muted">Pick the plan that matches your inventory volume.</p>
        </div>
        <div class="card">
          <h3>2. Complete Stripe checkout</h3>
          <p class="muted">Secure subscription checkout with a 14-day free trial.</p>
        </div>
        <div class="card">
          <h3>3. Dealer ID provisioning</h3>
          <p class="muted">We create your Dealer ID and prep your portal automatically.</p>
        </div>
      </div>
    </section>

    <section class="section">
      <h2>Start your 14-day trial</h2>
      <div class="tiers">
        <div class="tier-card">
          <div class="badge">Tier 1 • $45/mo</div>
          <strong>Essentials</strong>
          <div class="muted">Perfect for boutique dealers.</div>
          <div class="price">$45<span class="muted">/mo</span></div>
          <button class="btn btn-primary" data-tier="tier1">Get Listed!</button>
        </div>
        <div class="tier-card">
          <div class="badge">Tier 2 • $75/mo</div>
          <strong>Growth</strong>
          <div class="muted">For fast-moving inventory teams.</div>
          <div class="price">$75<span class="muted">/mo</span></div>
          <button class="btn btn-primary" data-tier="tier2">Get Listed!</button>
        </div>
        <div class="tier-card">
          <div class="badge">Tier 3 • $98/mo</div>
          <strong>Premium</strong>
          <div class="muted">Highest volume + concierge reporting.</div>
          <div class="price">$98<span class="muted">/mo</span></div>
          <button class="btn btn-primary" data-tier="tier3">Get Listed!</button>
        </div>
      </div>
      <div class="card" style="margin-top:16px">
        <h3>Dealer details</h3>
        <div class="form-grid">
          <input class="input" id="businessName" placeholder="Business name" />
          <input class="input" id="email" type="email" placeholder="Owner email" />
          <input class="input" id="whatsapp" placeholder="WhatsApp number (digits only)" />
        </div>
        <div class="muted" style="margin-top:8px">We use this to pre-fill your dealer profile and WhatsApp routing.</div>
        <div class="warning" id="checkoutStatus" style="display:none;margin-top:12px"></div>
      </div>
    </section>

    <section class="section" id="successSection" style="display:none">
      <h2>Setup in progress</h2>
      <div class="success" id="successBox">We’re setting up your dealer account. This usually takes a few seconds.</div>
    </section>

    <section class="section">
      <h2>FAQ</h2>
      <div class="faq">
        <div class="faq-item">
          <strong>What happens after I pay?</strong>
          <p class="muted">We auto-provision your Dealer ID and activate your portal. You’ll see your Dealer ID on this page once provisioning completes.</p>
        </div>
        <div class="faq-item">
          <strong>Is the trial really 14 days?</strong>
          <p class="muted">Yes. You get full access for 14 days. Billing starts after your trial ends.</p>
        </div>
        <div class="faq-item">
          <strong>Can I keep my inventory private?</strong>
          <p class="muted">Yes. Only buyers with your Dealer ID can view your inventory.</p>
        </div>
      </div>
    </section>
  </main>

  <footer>Auto Concierge Jamaica · Premium dealer onboarding</footer>

  <script>
    const buttons = Array.from(document.querySelectorAll("[data-tier]"));
    const ctaText = document.getElementById("ctaText");
    const businessName = document.getElementById("businessName");
    const email = document.getElementById("email");
    const whatsapp = document.getElementById("whatsapp");
    const checkoutStatus = document.getElementById("checkoutStatus");
    const successSection = document.getElementById("successSection");
    const successBox = document.getElementById("successBox");

    const ctaOptions = ["Get Listed!", "Become a Dealer"];
    let ctaIndex = 0;
    setInterval(() => {
      ctaIndex = (ctaIndex + 1) % ctaOptions.length;
      ctaText.style.opacity = 0;
      setTimeout(() => {
        const nextLabel = ctaOptions[ctaIndex];
        ctaText.textContent = nextLabel;
        buttons.forEach((btn) => {
          btn.textContent = nextLabel;
        });
        ctaText.style.opacity = 1;
      }, 240);
    }, 2200);

    async function startCheckout(tier){
      checkoutStatus.style.display = "block";
      checkoutStatus.textContent = "Redirecting to Stripe checkout…";
      try{
        const res = await fetch("/api/stripe/create-checkout-session", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            tier,
            businessName: businessName.value.trim(),
            email: email.value.trim(),
            whatsapp: whatsapp.value.trim(),
          })
        });
        const data = await res.json();
        if(!res.ok || !data?.ok) throw new Error(data?.error || "Checkout failed");
        window.location.href = data.url;
      }catch(err){
        checkoutStatus.textContent = err.message || "Unable to start checkout.";
      }
    }

    buttons.forEach((btn) => {
      btn.addEventListener("click", () => startCheckout(btn.dataset.tier));
    });

    async function pollProvisioning(sessionId){
      successSection.style.display = "block";
      successBox.textContent = "We’re setting up your dealer account. This usually takes a few seconds.";
      for(let i=0;i<6;i++){
        try{
          const res = await fetch(`/api/public/checkout-session?sessionId=${encodeURIComponent(sessionId)}`);
          const data = await res.json();
          if(res.ok && data?.ok && data.status === "ready" && data.dealer?.dealerId){
            successBox.textContent = `Dealer ID created: ${data.dealer.dealerId}. Check your email for next steps or contact support to set your passcode.`;
            return;
          }
        }catch(_err){}
        await new Promise(resolve => setTimeout(resolve, 3000));
      }
      successBox.textContent = "Dealer provisioning is still running. Refresh this page in a minute.";
    }

    const params = new URLSearchParams(window.location.search);
    if(params.get("status") === "success"){
      const sessionId = params.get("session_id");
      if(sessionId) pollProvisioning(sessionId);
    }
  </script>
</body>
</html>
